<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Udemy Business ì¸í„°ë™í‹°ë¸Œ ê°•ì˜ ëª©ë¡</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        /* [ê°œì„ ] Google Noto Sans KR í°íŠ¸ ì§ì ‘ ì„í¬íŠ¸ */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');

        /* [ê°œì„ ] ì „ì²´ì ì¸ ë””ìì¸ ì‹œìŠ¤í…œ(ìƒ‰ìƒ, í°íŠ¸, ê·¸ë¦¼ì ë“±) ì¬ì •ì˜ */
        :root {
            --bg-color: #121212;
            --surface-color: #1e1e1e;
            --primary-color: #0d6efd; /* Udemyì˜ íŒŒë€ìƒ‰ ê³„ì—´ë¡œ ë³€ê²½í•˜ì—¬ ë¸Œëœë“œ í†µì¼ì„± í™•ë³´ */
            --primary-hover-color: #0b5ed7;
            --text-color: #e0e0e0;
            --text-muted-color: #a0a0a0;
            --border-color: #3a3a3a;
            --border-radius-sm: 6px;
            --border-radius-md: 10px;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.2);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.3);
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 2rem;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* [ê°œì„ ] ì´ˆê¸° í™”ë©´ UI/UX ê°œì„  */
        #initial-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: calc(100vh - 4rem);
            text-align: center;
            transition: opacity 0.5s ease-out;
            max-width: 600px;
            margin: 0 auto;
        }
        #initial-screen h1 {
            font-size: 2.8rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 0.5rem;
        }
        #initial-screen p {
            font-size: 1.1rem;
            color: var(--text-muted-color);
            margin-bottom: 2rem;
        }
        .input-group {
            display: flex;
            background-color: var(--surface-color);
            border-radius: var(--border-radius-md);
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            width: 100%;
            box-shadow: var(--shadow-md);
        }
        .input-group input {
            flex-grow: 1;
            background: transparent;
            border: none;
            color: var(--text-color);
            font-size: 1.1rem;
            padding: 0.75rem;
            outline: none;
        }
        .input-group button {
            background-color: var(--primary-color);
            color: #fff;
            border: none;
            padding: 0.75rem 1.75rem;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
            font-size: 1rem;
        }
        .input-group button:hover {
            background-color: var(--primary-hover-color);
        }
        .input-group button:disabled {
            background-color: #555;
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* [ê°œì„ ] ë©”ì¸ ì•± ì»¨í…Œì´ë„ˆ ë ˆì´ì•„ì›ƒ ë° ë””ìì¸ ê°œì„  */
        #app-container {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease-in;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* [ê°œì„ ] ê²€ìƒ‰, í•„í„° ë“± ì»¨íŠ¸ë¡¤ ì˜ì—­ UI ê°œì„  */
        .controls-header {
            background-color: var(--surface-color);
            padding: 1.5rem 2rem;
            border-radius: var(--border-radius-md);
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
        }
        .search-container {
            display: flex;
            align-items: center;
            width: 100%;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            padding: 0.25rem 1rem;
            margin-bottom: 1.5rem;
        }
        .search-container:focus-within {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(13, 110, 253, 0.25);
        }
        .search-container input {
            width: 100%;
            padding: 0.75rem 0.5rem;
            background-color: transparent;
            border: none;
            color: var(--text-color);
            font-size: 1.1rem;
            outline: none;
        }
        .filters-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            align-items: center;
        }
        .filter-group { display: flex; flex-direction: column; gap: 0.5rem; }
        .filter-group label { font-size: 0.9rem; color: var(--text-muted-color); font-weight: 500; }
        .filter-group select {
            width: 100%;
            padding: 0.75rem;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-color);
            font-size: 1rem;
            cursor: pointer;
        }
        .actions { display: flex; align-items: flex-end; }
        .actions button {
            width: 100%;
            padding: 0.75rem;
            background-color: var(--surface-color);
            border: 1px solid var(--border-color);
            color: var(--text-muted-color);
            font-size: 1rem;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: all 0.2s;
        }
        .actions button:hover { background-color: #333; color: var(--text-color); }
        .results-summary {
            margin-bottom: 1rem;
            color: var(--text-muted-color);
        }
        .results-summary b {
            color: var(--primary-color);
            font-weight: 700;
        }

        /* [ê°œì„ ] í…Œì´ë¸” ë””ìì¸ ë° ê°€ë…ì„± í–¥ìƒ */
        .table-container {
            overflow-x: auto;
            background-color: var(--surface-color);
            border-radius: var(--border-radius-md);
            border: 1px solid var(--border-color);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            white-space: nowrap;
        }
        th, td {
            padding: 1.25rem 1.5rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        thead {
            background-color: rgba(0,0,0,0.2);
            position: sticky;
            top: 0;
            z-index: 10;
        }
        th {
            cursor: pointer;
            user-select: none;
            font-weight: 500;
            color: var(--text-muted-color);
        }
        th .sort-indicator {
            display: inline-block;
            margin-left: 0.5rem;
            opacity: 0.7;
            font-size: 0.8em;
        }
        tbody tr:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        td a {
            color: var(--text-color);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s;
        }
        td a:hover { color: var(--primary-color); }
        .rating { font-weight: bold; color: #ffd700; }

        /* [ê°œì„ ] í˜ì´ì§€ë„¤ì´ì…˜ UI ê°œì„  */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 2.5rem;
            gap: 0.5rem;
            user-select: none;
        }
        .pagination button, .pagination span {
            background-color: var(--surface-color);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 0.6rem 1.1rem;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: all 0.2s;
        }
        .pagination button:hover, .pagination button.active {
            background-color: var(--primary-color);
            color: #fff;
            border-color: var(--primary-color);
        }
        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background-color: transparent;
        }
        .pagination span {
            cursor: default;
            background-color: transparent;
        }
    </style>
</head>
<body>

<div id="initial-screen">
    <h1>Udemy Business ê°•ì˜ ëª©ë¡</h1>
    <p>ì‹œì‘í•˜ë ¤ë©´ ê·€ì‚¬ì˜ Udemy Business ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.<br>(ì˜ˆ: company-name.udemy.comì˜ ê²½ìš° company-name ì…ë ¥)</p>
    <div class="input-group">
        <input id="company-address" placeholder="íšŒì‚¬ ì£¼ì†Œ (ì˜ˆ: woongjin)" type="text" />
        <button id="submit-address">ê°•ì˜ ëª©ë¡ í™•ì¸</button>
    </div>
</div>

<div id="app-container">
    </div>

<script>
    // --- ì „ì—­ ë³€ìˆ˜ ë° ìƒíƒœ (í•µì‹¬ ë¡œì§ ë³€ê²½ ì—†ìŒ) ---
    let companyUrl = '';
    let filteredCourses = [];
    let currentPage = 1;
    const rowsPerPage = 15;
    let sortColumn = 'title';
    let sortDirection = 'asc';
    let originalData = [];

    // --- DOM ìš”ì†Œ ---
    const initialScreen = document.getElementById('initial-screen');
    const appContainer = document.getElementById('app-container');
    const submitBtn = document.getElementById('submit-address');
    const companyAddressInput = document.getElementById('company-address');
    
    // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
    submitBtn.addEventListener('click', initializeApp);
    companyAddressInput.addEventListener('keyup', (e) => {
        if (e.key === 'Enter') initializeApp();
    });

    const columnMapping = {
        'ê°•ì˜ ID / ì½”ìŠ¤ ID': 'id',
        'ê°•ì˜ ì œëª© / ì½”ìŠ¤ ì œëª©': 'title',
        'ê°•ì‚¬ ì´ë¦„': 'instructor',
        'ê°•ì˜ ë‚œì´ë„': 'difficulty',
        'ì¹´í…Œê³ ë¦¬ ëª©ë¡': 'category',
        'ê°•ì˜ ì£¼ì œ ëª©ë¡': 'topic',
        'í‰ì ': 'rating',
        'ê°•ì˜ í—¤ë“œë¼ì¸ / ì†Œê°œ ë¬¸êµ¬': 'headline',
        'í•™ìŠµ ëª©í‘œ / ë°°ìš¸ ë‚´ìš©': 'objectives'
    };

    // --- ë°ì´í„° ë¡œë”© í•¨ìˆ˜ (í•µì‹¬ ë¡œì§ ë³€ê²½ ì—†ìŒ) ---
    async function loadCourseData() {
        return new Promise((resolve, reject) => {
            const csvFilePath = 'courses_web.csv'; // ìƒëŒ€ ê²½ë¡œë¡œ ìˆ˜ì •

            Papa.parse(csvFilePath, {
                download: true,
                header: true,
                skipEmptyLines: true,
                complete: (results) => {
                    if (results.errors.length > 0) {
                        console.error("CSV íŒŒì‹± ì—ëŸ¬:", results.errors);
                        alert("CSV íŒŒì¼ì„ ë¶„ì„í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
                        return reject(new Error("CSV íŒŒì‹± ì˜¤ë¥˜"));
                    }
                    
                    const processedData = results.data.map(row => {
                        const newRow = {};
                        for (const key in columnMapping) {
                            if (row[key] !== undefined) {
                                newRow[columnMapping[key]] = row[key];
                            }
                        }
                        newRow.rating = parseFloat(newRow.rating) || 0;
                        return newRow;
                    }).filter(row => row.id && row.title);
                    
                    resolve(processedData);
                },
                error: (error) => {
                    console.error("CSV íŒŒì¼ ë¡œë“œ ì—ëŸ¬:", error);
                    alert("ê°•ì˜ ë°ì´í„°(CSV)ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. íŒŒì¼ ì´ë¦„ê³¼ ê²½ë¡œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");
                    reject(error);
                }
            });
        });
    }

    // --- ì•± ì´ˆê¸°í™” í•¨ìˆ˜ (í•µì‹¬ ë¡œì§ ë³€ê²½ ì—†ìŒ, UI ìƒì„± ì½”ë“œë§Œ ìˆ˜ì •) ---
    async function initializeApp() {
        const address = companyAddressInput.value.trim();
        if (!address) {
            alert('íšŒì‚¬ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            return;
        }
        companyUrl = `https://${address}.udemy.com/course/`;
        
        submitBtn.disabled = true;
        submitBtn.innerHTML = 'ë°ì´í„° ë¡œë”© ì¤‘...';
        
        try {
            originalData = await loadCourseData();
        } catch (error) {
            submitBtn.disabled = false;
            submitBtn.innerHTML = 'ê°•ì˜ ëª©ë¡ í™•ì¸';
            return;
        }

        if (originalData.length === 0) {
             alert("ë¡œë“œëœ ê°•ì˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. CSV íŒŒì¼ ë‚´ìš©ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
             submitBtn.disabled = false;
             submitBtn.innerHTML = 'ê°•ì˜ ëª©ë¡ í™•ì¸';
             return;
        }
        
        initialScreen.style.opacity = '0';
        setTimeout(() => {
            initialScreen.style.display = 'none';
            // [ê°œì„ ] ìƒˆë¡œìš´ UI êµ¬ì¡°ë¥¼ ìƒì„±í•˜ëŠ” HTML
            appContainer.innerHTML = `
                <div class="controls-header">
                    <div class="search-container">
                        <span>ğŸ”</span>
                        <input type="text" id="search" placeholder="ê°•ì˜ëª…, ê°•ì‚¬, ì£¼ì œ, í•™ìŠµ ë‚´ìš© ë“± ììœ ë¡­ê²Œ ê²€ìƒ‰í•˜ì„¸ìš”...">
                    </div>
                    <div class="filters-container">
                        <div class="filter-group">
                            <label for="category-filter">ì¹´í…Œê³ ë¦¬</label>
                            <select id="category-filter"><option value="">ëª¨ë“  ì¹´í…Œê³ ë¦¬</option></select>
                        </div>
                        <div class="filter-group">
                            <label for="difficulty-filter">ë‚œì´ë„</label>
                            <select id="difficulty-filter">
                                <option value="">ëª¨ë“  ë‚œì´ë„</option>
                                <option>Beginner</option>
                                <option>Intermediate</option>
                                <option>Expert</option>
                                <option>All Levels</option>
                            </select>
                        </div>
                        <div class="actions">
                            <button id="reset-filters">ğŸ”„ï¸ ì´ˆê¸°í™”</button>
                        </div>
                    </div>
                </div>

                <div class="results-summary" id="results-summary"></div>

                <div class="table-container">
                    <table>
                        <thead><tr>
                            <th data-sort="title">ê°•ì˜ëª… <span class="sort-indicator"></span></th>
                            <th data-sort="instructor">ê°•ì‚¬ëª… <span class="sort-indicator"></span></th>
                            <th data-sort="category">ì¹´í…Œê³ ë¦¬ <span class="sort-indicator"></span></th>
                            <th data-sort="topic">ì£¼ì œ <span class="sort-indicator"></span></th>
                            <th data-sort="difficulty">ë‚œì´ë„ <span class="sort-indicator"></span></th>
                            <th data-sort="rating">í‰ì  <span class="sort-indicator"></span></th>
                        </tr></thead>
                        <tbody id="course-table-body"></tbody>
                    </table>
                </div>
                <div class="pagination" id="pagination"></div>`;
            
            appContainer.style.display = 'block';
            setTimeout(() => appContainer.style.opacity = '1', 50);

            // [ê°œì„ ] ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆì— ì´ˆê¸°í™” ë²„íŠ¼ ì¶”ê°€
            document.getElementById('search').addEventListener('input', handleFilters);
            document.getElementById('category-filter').addEventListener('change', handleFilters);
            document.getElementById('difficulty-filter').addEventListener('change', handleFilters);
            document.getElementById('reset-filters').addEventListener('click', resetAllFilters);
            document.querySelector('thead').addEventListener('click', (e) => {
                const header = e.target.closest('th');
                if (header && header.dataset.sort) handleSort(header.dataset.sort);
            });

            populateCategoryFilter();
            handleFilters();
        }, 500);
    }
    
    // [ê°œì„ ] ëª¨ë“  í•„í„°ë¥¼ ì´ˆê¸°í™”í•˜ëŠ” í•¨ìˆ˜
    function resetAllFilters() {
        document.getElementById('search').value = '';
        document.getElementById('category-filter').value = '';
        document.getElementById('difficulty-filter').value = '';
        sortColumn = 'title';
        sortDirection = 'asc';
        currentPage = 1;
        renderTable();
    }

    // --- ì¹´í…Œê³ ë¦¬ í•„í„° ìƒì„± í•¨ìˆ˜ (í•µì‹¬ ë¡œì§ ë³€ê²½ ì—†ìŒ) ---
    function populateCategoryFilter() {
        const categoryFilterEl = document.getElementById('category-filter');
        const categories = new Set();
        originalData.forEach(course => {
            if (course.category) {
                course.category.split(',').forEach(cat => categories.add(cat.trim()));
            }
        });
        
        [...categories].sort().forEach(cat => {
            const option = document.createElement('option');
            option.value = cat;
            option.textContent = cat;
            categoryFilterEl.appendChild(option);
        });
    }

    // --- í…Œì´ë¸” ë Œë”ë§ í•¨ìˆ˜ (í•µì‹¬ ë¡œì§ ë³€ê²½ ì—†ìŒ, ê²°ê³¼ ìš”ì•½ ê¸°ëŠ¥ ì¶”ê°€) ---
    function renderTable() {
        const tableBody = document.getElementById('course-table-body');
        const searchTerm = document.getElementById('search').value.toLowerCase();
        const selectedCategory = document.getElementById('category-filter').value;
        const selectedDifficulty = document.getElementById('difficulty-filter').value;

        filteredCourses = originalData.filter(course => {
            const searchCorpus = `
                ${course.title || ''} 
                ${course.instructor || ''} 
                ${course.topic || ''} 
                ${course.headline || ''} 
                ${course.objectives || ''}
            `.toLowerCase();

            const matchesSearch = searchTerm === '' || searchCorpus.includes(searchTerm);
            const matchesCategory = selectedCategory === '' || (course.category && course.category.includes(selectedCategory));
            const matchesDifficulty = selectedDifficulty === '' || course.difficulty === selectedDifficulty;
            return matchesSearch && matchesCategory && matchesDifficulty;
        });

        // [ê°œì„ ] ê²€ìƒ‰ ê²°ê³¼ ìš”ì•½ ì—…ë°ì´íŠ¸
        const summaryEl = document.getElementById('results-summary');
        summaryEl.innerHTML = `ì´ <b>${originalData.length}</b>ê°œì˜ ê°•ì˜ ì¤‘ <b>${filteredCourses.length}</b>ê°œì˜ ê²°ê³¼ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.`;

        filteredCourses.sort((a, b) => {
            let valA = a[sortColumn] || '';
            let valB = b[sortColumn] || '';
            if (typeof valA === 'string') {
                valA = valA.toLowerCase();
                valB = valB.toLowerCase();
            }
            if (valA < valB) return sortDirection === 'asc' ? -1 : 1;
            if (valA > valB) return sortDirection === 'asc' ? 1 : -1;
            return 0;
        });
        updateSortIndicators();
        const totalPages = Math.ceil(filteredCourses.length / rowsPerPage);
        const start = (currentPage - 1) * rowsPerPage;
        const end = start + rowsPerPage;
        const paginatedCourses = filteredCourses.slice(start, end);
        tableBody.innerHTML = paginatedCourses.map(course => `
            <tr>
                <td><a href="${companyUrl}${course.id}" target="_blank" title="${course.headline || course.title}">${course.title}</a></td>
                <td>${course.instructor || ''}</td>
                <td>${course.category || ''}</td>
                <td>${course.topic || ''}</td>
                <td>${course.difficulty || ''}</td>
                <td class="rating">${course.rating > 0 ? `â­ ${course.rating.toFixed(1)}` : 'N/A'}</td>
            </tr>`).join('');
        renderPagination(totalPages);
    }

    // --- í•¸ë“¤ëŸ¬ ë° ê¸°íƒ€ í•¨ìˆ˜ë“¤ (í•µì‹¬ ë¡œì§ ë³€ê²½ ì—†ìŒ) ---
    function handleFilters() { currentPage = 1; renderTable(); }
    function handleSort(column) {
        if (sortColumn === column) {
            sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
        } else {
            sortColumn = column;
            sortDirection = 'asc';
        }
        currentPage = 1;
        renderTable();
    }
    function updateSortIndicators() {
        document.querySelectorAll('th .sort-indicator').forEach(span => span.textContent = '');
        const activeIndicator = document.querySelector(`th[data-sort="${sortColumn}"] .sort-indicator`);
        if (activeIndicator) activeIndicator.textContent = sortDirection === 'asc' ? 'â–²' : 'â–¼';
    }
    
    // --- í˜ì´ì§€ë„¤ì´ì…˜ ë Œë”ë§ í•¨ìˆ˜ (í•µì‹¬ ë¡œì§ ë³€ê²½ ì—†ìŒ, UI ê°œì„ ì„ ìœ„í•œ ì†Œí­ ìˆ˜ì •) ---
    function renderPagination(totalPages) {
        const paginationContainer = document.getElementById('pagination');
        paginationContainer.innerHTML = '';
        if (totalPages <= 1) return;
        const prevButton = document.createElement('button');
        prevButton.textContent = 'ì´ì „';
        prevButton.disabled = currentPage === 1;
        prevButton.addEventListener('click', () => { if (currentPage > 1) { currentPage--; renderTable(); } });
        paginationContainer.appendChild(prevButton);
        let pageNumbers = [];
        if (totalPages <= 7) {
            for (let i = 1; i <= totalPages; i++) pageNumbers.push(i);
        } else {
            pageNumbers = [1, 2];
            if (currentPage > 4) pageNumbers.push('...');
            for (let i = Math.max(3, currentPage - 1); i <= Math.min(totalPages - 2, currentPage + 1); i++) pageNumbers.push(i);
            if (currentPage < totalPages - 3) pageNumbers.push('...');
            pageNumbers.push(totalPages - 1, totalPages);
        }
        pageNumbers.forEach(num => {
            if(num === '...') {
                const span = document.createElement('span');
                span.textContent = '...';
                paginationContainer.appendChild(span);
            } else {
                const pageButton = document.createElement('button');
                pageButton.textContent = num;
                if (num === currentPage) pageButton.classList.add('active');
                pageButton.addEventListener('click', () => { currentPage = num; renderTable(); });
                paginationContainer.appendChild(pageButton);
            }
        });
        const nextButton = document.createElement('button');
        nextButton.textContent = 'ë‹¤ìŒ';
        nextButton.disabled = currentPage === totalPages;
        nextButton.addEventListener('click', () => { if (currentPage < totalPages) { currentPage++; renderTable(); } });
        paginationContainer.appendChild(nextButton);
    }
</script>
</body>
</html>
