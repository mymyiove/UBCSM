<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Udemy Business ì¸í„°ë™í‹°ë¸Œ ê°•ì˜ ëª©ë¡</title>
    <!-- CSV íŒŒì‹± ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
        :root {
            --bg-color: #1a1a1a;
            --surface-color: #2c2c2c;
            --primary-color: #a972ff;
            --text-color: #e0e0e0;
            --text-muted-color: #8c8c8c;
            --border-color: #444;
        }
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 2rem;
            line-height: 1.6;
        }
        #initial-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: calc(100vh - 4rem);
            text-align: center;
            transition: opacity 0.5s ease-out;
        }
        h1 { font-size: 2.5rem; color: #fff; }
        .input-group { display: flex; gap: 0.5rem; background-color: var(--surface-color); padding: 0.5rem; border-radius: 8px; }
        input { background: transparent; border: none; color: var(--text-color); font-size: 1rem; padding: 0.75rem; width: 300px; }
        button { background-color: var(--primary-color); color: #fff; border: none; padding: 0.75rem 1.5rem; border-radius: 6px; cursor: pointer; font-weight: 500; transition: background-color 0.2s; }
        button:hover { background-color: #b98cff; }
        button:disabled { background-color: #555; cursor: not-allowed; }
        #app-container { display: none; opacity: 0; transition: opacity 0.5s ease-in; }
        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 2rem; background-color: var(--surface-color); padding: 1.5rem; border-radius: 12px; }
        .filters { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; }
        select, .search-box input { width: 100%; padding: 0.75rem; background-color: var(--bg-color); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-color); font-size: 1rem; }
        .table-container { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; white-space: nowrap; }
        th, td { padding: 1rem 1.25rem; text-align: left; border-bottom: 1px solid var(--border-color); }
        thead { background-color: #333; position: sticky; top: 0; z-index: 10; }
        th { cursor: pointer; user-select: none; }
        th .sort-indicator { display: inline-block; margin-left: 0.5rem; opacity: 0.5; }
        tbody tr:hover { background-color: var(--surface-color); }
        td a { color: var(--primary-color); text-decoration: none; font-weight: 500; }
        .rating { font-weight: bold; color: #ffd700; }
        .pagination { display: flex; justify-content: center; align-items:center; margin-top: 2rem; gap: 0.5rem; }
        .pagination button { background-color: var(--surface-color); border: 1px solid var(--border-color); color: var(--text-color); padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; }
        .pagination button:hover, .pagination button.active { background-color: var(--primary-color); color: #fff; }
        .pagination button:disabled { opacity: 0.5; cursor: not-allowed; }
    </style>
</head>
<body>

    <div id="initial-screen">
        <h1>Udemy Business ê°•ì˜ ëª©ë¡</h1>
        <p>ì‹œì‘í•˜ë ¤ë©´ ê·€ì‚¬ì˜ Udemy Business ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
        <div class="input-group">
            <input type="text" id="company-address" placeholder="semacademy" value="semacademy">
            <button id="submit-address">ê°•ì˜ ëª©ë¡ í™•ì¸</button>
        </div>
    </div>
    <div id="app-container">
        <!-- App container HTML will be generated by JavaScript -->
    </div>

    <script>
        // --- ì „ì—­ ë³€ìˆ˜ ë° ìƒíƒœ ---
        let companyUrl = '';
        let filteredCourses = [];
        let currentPage = 1;
        const rowsPerPage = 15;
        let sortColumn = 'title';
        let sortDirection = 'asc';
        let originalData = []; // ì›ë³¸ ë°ì´í„°ë¥¼ ì €ì¥í•  ë°°ì—´

        // --- DOM ìš”ì†Œ ---
        const initialScreen = document.getElementById('initial-screen');
        const appContainer = document.getElementById('app-container');
        const submitBtn = document.getElementById('submit-address');
        const companyAddressInput = document.getElementById('company-address');
        
        // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
        submitBtn.addEventListener('click', initializeApp);

        // [!!ìˆ˜ì •!!] ê²€ìƒ‰í•  ì—´ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
        const columnMapping = {
            'ê°•ì˜ ID / ì½”ìŠ¤ ID': 'id',
            'ê°•ì˜ ì œëª© / ì½”ìŠ¤ ì œëª©': 'title',
            'ê°•ì‚¬ ì´ë¦„': 'instructor',
            'ê°•ì˜ ë‚œì´ë„': 'difficulty',
            'ì¹´í…Œê³ ë¦¬ ëª©ë¡': 'category',
            'ê°•ì˜ ì£¼ì œ ëª©ë¡': 'topic',
            'í‰ì ': 'rating',
            'ê°•ì˜ í—¤ë“œë¼ì¸ / ì†Œê°œ ë¬¸êµ¬': 'headline',
            'í•™ìŠµ ëª©í‘œ / ë°°ìš¸ ë‚´ìš©': 'objectives'
        };

        // ë°ì´í„°ë¥¼ CSV íŒŒì¼ë¡œë¶€í„° ì§ì ‘ fetchí•˜ê³  íŒŒì‹±í•˜ëŠ” í•¨ìˆ˜
        async function loadCourseData() {
            return new Promise((resolve, reject) => {
                const csvFilePath = '/sem-udemy-business-course-list/courses_web.csv';

                Papa.parse(csvFilePath, {
                    download: true,
                    header: true,
                    skipEmptyLines: true,
                    complete: (results) => {
                        if (results.errors.length > 0) {
                            console.error("CSV íŒŒì‹± ì—ëŸ¬:", results.errors);
                            alert("CSV íŒŒì¼ì„ ë¶„ì„í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
                            return reject(new Error("CSV íŒŒì‹± ì˜¤ë¥˜"));
                        }
                        
                        const processedData = results.data.map(row => {
                            const newRow = {};
                            for (const key in columnMapping) {
                                if (row[key] !== undefined) {
                                    newRow[columnMapping[key]] = row[key];
                                }
                            }
                            newRow.rating = parseFloat(newRow.rating) || 0;
                            return newRow;
                        }).filter(row => row.id && row.title);
                        
                        resolve(processedData);
                    },
                    error: (error) => {
                        console.error("CSV íŒŒì¼ ë¡œë“œ ì—ëŸ¬:", error);
                        alert("ê°•ì˜ ë°ì´í„°(CSV)ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. íŒŒì¼ ì´ë¦„ê³¼ ê²½ë¡œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");
                        reject(error);
                    }
                });
            });
        }

        async function initializeApp() {
            const address = companyAddressInput.value.trim();
            if (!address) {
                alert('íšŒì‚¬ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            companyUrl = `https://${address}.udemy.com/course/`;
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'ë°ì´í„° ë¡œë”© ì¤‘...';
            
            try {
                originalData = await loadCourseData();
            } catch (error) {
                submitBtn.disabled = false;
                submitBtn.textContent = 'ê°•ì˜ ëª©ë¡ í™•ì¸';
                return;
            }

            if (originalData.length === 0) {
                 alert("ë¡œë“œëœ ê°•ì˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. CSV íŒŒì¼ ë‚´ìš©ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
                 submitBtn.disabled = false;
                 submitBtn.textContent = 'ê°•ì˜ ëª©ë¡ í™•ì¸';
                 return;
            }
            
            initialScreen.style.opacity = '0';
            setTimeout(() => {
                initialScreen.style.display = 'none';
                appContainer.innerHTML = `
                    <div class="controls">
                        <div class="search-box"><input type="text" id="search" placeholder="ğŸ” ê°•ì˜ëª…, ê°•ì‚¬ëª…, ì£¼ì œ, ë‚´ìš© ë“±ìœ¼ë¡œ ê²€ìƒ‰..."></div>
                        <div class="filters">
                            <select id="category-filter"><option value="">ëª¨ë“  ì¹´í…Œê³ ë¦¬</option></select>
                            <select id="difficulty-filter"><option value="">ëª¨ë“  ë‚œì´ë„</option><option>Beginner</option><option>Intermediate</option><option>Expert</option><option>All Levels</option></select>
                        </div>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead><tr>
                                <th data-sort="title">ê°•ì˜ëª… <span class="sort-indicator"></span></th><th data-sort="instructor">ê°•ì‚¬ëª… <span class="sort-indicator"></span></th>
                                <th data-sort="category">ì¹´í…Œê³ ë¦¬ <span class="sort-indicator"></span></th><th data-sort="topic">ì£¼ì œ <span class="sort-indicator"></span></th>
                                <th data-sort="difficulty">ë‚œì´ë„ <span class="sort-indicator"></span></th><th data-sort="rating">í‰ì  <span class="sort-indicator"></span></th>
                            </tr></thead>
                            <tbody id="course-table-body"></tbody>
                        </table>
                    </div>
                    <div class="pagination" id="pagination"></div>`;
                appContainer.style.display = 'block';
                setTimeout(() => appContainer.style.opacity = '1', 50);

                document.getElementById('search').addEventListener('input', handleFilters);
                document.getElementById('category-filter').addEventListener('change', handleFilters);
                document.getElementById('difficulty-filter').addEventListener('change', handleFilters);
                document.querySelector('thead').addEventListener('click', (e) => {
                    const header = e.target.closest('th');
                    if (header && header.dataset.sort) handleSort(header.dataset.sort);
                });

                populateCategoryFilter();
                handleFilters();
            }, 500);
        }
        
        function populateCategoryFilter() {
            const categoryFilterEl = document.getElementById('category-filter');
            const categories = new Set();
            originalData.forEach(course => {
                if (course.category) {
                    course.category.split(',').forEach(cat => categories.add(cat.trim()));
                }
            });
            
            [...categories].sort().forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                categoryFilterEl.appendChild(option);
            });
        }

        function renderTable() {
            const tableBody = document.getElementById('course-table-body');
            const searchTerm = document.getElementById('search').value.toLowerCase();
            const selectedCategory = document.getElementById('category-filter').value;
            const selectedDifficulty = document.getElementById('difficulty-filter').value;

            filteredCourses = originalData.filter(course => {
                // [!!ìˆ˜ì •!!] ê²€ìƒ‰ ë²”ìœ„ë¥¼ ê°•ì˜ ì†Œê°œì™€ ë°°ìš¸ ë‚´ìš©ê¹Œì§€ í™•ì¥í•©ë‹ˆë‹¤.
                const searchCorpus = `
                    ${course.title || ''} 
                    ${course.instructor || ''} 
                    ${course.topic || ''} 
                    ${course.headline || ''} 
                    ${course.objectives || ''}
                `.toLowerCase();

                const matchesSearch = searchTerm === '' || searchCorpus.includes(searchTerm);
                const matchesCategory = selectedCategory === '' || (course.category && course.category.includes(selectedCategory));
                const matchesDifficulty = selectedDifficulty === '' || course.difficulty === selectedDifficulty;
                return matchesSearch && matchesCategory && matchesDifficulty;
            });

            filteredCourses.sort((a, b) => {
                let valA = a[sortColumn] || '';
                let valB = b[sortColumn] || '';
                if (typeof valA === 'string') {
                    valA = valA.toLowerCase();
                    valB = valB.toLowerCase();
                }
                if (valA < valB) return sortDirection === 'asc' ? -1 : 1;
                if (valA > valB) return sortDirection === 'asc' ? 1 : -1;
                return 0;
            });
            updateSortIndicators();
            const totalPages = Math.ceil(filteredCourses.length / rowsPerPage);
            const start = (currentPage - 1) * rowsPerPage;
            const end = start + rowsPerPage;
            const paginatedCourses = filteredCourses.slice(start, end);
            tableBody.innerHTML = paginatedCourses.map(course => `
                <tr>
                    <td><a href="${companyUrl}${course.id}" target="_blank" title="${course.title}">${course.title}</a></td>
                    <td>${course.instructor || ''}</td>
                    <td>${course.category || ''}</td>
                    <td>${course.topic || ''}</td>
                    <td>${course.difficulty || ''}</td>
                    <td class="rating">${course.rating > 0 ? `â­ ${course.rating.toFixed(1)}` : 'N/A'}</td>
                </tr>`).join('');
            renderPagination(totalPages);
        }

        function handleFilters() { currentPage = 1; renderTable(); }
        function handleSort(column) {
            if (sortColumn === column) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn = column;
                sortDirection = 'asc';
            }
            currentPage = 1;
            renderTable();
        }
        function updateSortIndicators() {
            document.querySelectorAll('th .sort-indicator').forEach(span => span.textContent = '');
            const activeIndicator = document.querySelector(`th[data-sort="${sortColumn}"] .sort-indicator`);
            if (activeIndicator) activeIndicator.textContent = sortDirection === 'asc' ? 'â–²' : 'â–¼';
        }
        function renderPagination(totalPages) {
            const paginationContainer = document.getElementById('pagination');
            paginationContainer.innerHTML = '';
            if (totalPages <= 1) return;
            const prevButton = document.createElement('button');
            prevButton.textContent = 'ì´ì „';
            prevButton.disabled = currentPage === 1;
            prevButton.addEventListener('click', () => { if (currentPage > 1) { currentPage--; renderTable(); } });
            paginationContainer.appendChild(prevButton);
            let pageNumbers = [];
            if (totalPages <= 7) {
                for (let i = 1; i <= totalPages; i++) pageNumbers.push(i);
            } else {
                pageNumbers = [1, 2];
                if (currentPage > 4) pageNumbers.push('...');
                for (let i = Math.max(3, currentPage - 1); i <= Math.min(totalPages - 2, currentPage + 1); i++) pageNumbers.push(i);
                if (currentPage < totalPages - 3) pageNumbers.push('...');
                pageNumbers.push(totalPages - 1, totalPages);
            }
            pageNumbers.forEach(num => {
                if(num === '...') {
                    const span = document.createElement('span');
                    span.textContent = '...';
                    span.style.padding = '0.5rem 1rem';
                    paginationContainer.appendChild(span);
                } else {
                    const pageButton = document.createElement('button');
                    pageButton.textContent = num;
                    if (num === currentPage) pageButton.classList.add('active');
                    pageButton.addEventListener('click', () => { currentPage = num; renderTable(); });
                    paginationContainer.appendChild(pageButton);
                }
            });
            const nextButton = document.createElement('button');
            nextButton.textContent = 'ë‹¤ìŒ';
            nextButton.disabled = currentPage === totalPages;
            nextButton.addEventListener('click', () => { if (currentPage < totalPages) { currentPage++; renderTable(); } });
            paginationContainer.appendChild(nextButton);
        }
    </script>
</body>
</html>

